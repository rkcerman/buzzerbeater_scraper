{% if player %}
<link rel="stylesheet" href="http://www.buzzerbeater.com/CSS/contentbox.css?c=2" type="text/css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.3.1/dt-1.10.18/rg-1.0.3/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.3.1/dt-1.10.18/rg-1.0.3/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/fixedcolumns/3.2.6/js/dataTables.fixedColumns.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
    var groupColumn = 1;
    var table = $('#matchHistory').DataTable({
        "columnDefs": [
            { visible: false, targets: 0},
            { width: '20%', targets : [2,3,4,5]},
            { visible: false, targets: groupColumn },
        ],
        "order": [[ 2, 'desc' ]],
        "displayLength": 25,
        "drawCallback": function ( settings ) {
            var api = this.api();
            var rows = api.rows( {page:'current'} ).nodes();
            var last=null;

            api.column(groupColumn, {page:'current'} ).data().each( function ( group, i ) {
                if ( last !== group ) {
                    $(rows).eq( i ).before(
                        '<tr class="group"><td colspan="16">'+group+'</td></tr>'
                    );

                    last = group;
                }
            } );
        }
    } );

    // Order by the grouping
    $('#matchHistory tbody').on( 'click', 'tr.group', function () {
        var currentOrder = table.order()[0];
        if ( currentOrder[0] === groupColumn && currentOrder[1] === 'asc' ) {
            table.order( [ groupColumn, 'desc' ] ).draw();
        }
        else {
            table.order( [ groupColumn, 'asc' ] ).draw();
        }
    } );
} );
</script>


<style type="text/css">
    body
    {
        text-align: center;
    }
    div.playerinfobox {
        margin: auto 15% auto 15%;
        width: 50%;
    }
    table.playerinfo {
        margin: 0 auto;
        width: 100%;
        clear: both;
        border-collapse: collapse;
        table-layout: fixed;
        word-wrap:normal;
    }
    table.playerinfo tr {
        font-size: 15px;
    }
    tr.group,
    tr.group:hover {
        background-color: #ddd !important;
    }

</style>
<div class="playerinfobox">
    <table class="playerinfo" cellpadding="0" cellspacing="0">
        <tr>
            <h2> {{ player.name }} </h2>
        </tr>
        <tr>
            <td style="vertical-align: top; width: 230px">
                <table style="margin: 1px;">
                    <tr>
                        <td id="playerPersonalInfo">
                            <p>
                                <b> {{ player.position }} </b>
                                <br />
                                <br /> Team:
                                <a id="ctl00_cphContent_teamName" href="/team/{{ player.team.id }}/overview.html">{{ team.name }}</a>
                                <br />
                                <br /> Weekly salary: $ {{ player.weekly_salary }}

                                <br />
                                <br /> DMI: {{ player.dmi }}

                                <br />
                                <br /> Age: {{ player.age }}

                                <br />
                                <br /> Height: {{ player.height }}cm

                            </p>
                        </td>
                    </tr>
                </table>
            </td>
            {% if skills %}

            <td style="width: 320px; height: 120px;">
                <table style="margin: 1px; padding: 0px;">
                    <tr style="background: #EFEFEF;">
                        <td>
                            Jump Shot:

                            <a id="ctl00_cphContent_skillTable_sdJumpShot_linkDen" class="lev{{ skills.jump_shot.0 }}" title="{{ skills.jump_shot.0 }}">{{ skills.jump_shot.1 }}</a>
                        </td>
                        <td>
                            Jump Range:

                            <a id="ctl00_cphContent_skillTable_sdJumpRange_linkDen" class="lev{{ skills.jump_range.0 }}" title="{{ skills.jump_range }}">{{ skills.jump_range.1 }}</a>
                        </td>
                    </tr>
                    <tr style="background: #EFEFEF;">
                        <td>
                            Outside Def.:

                            <a id="ctl00_cphContent_skillTable_sdperimDef_linkDen" class="lev{{ skills.outside_def.0 }}" title="{{ skills.outside_def }}">{{ skills.outside_def.1 }}</a>
                        </td>
                        <td>
                            Handling:

                            <a id="ctl00_cphContent_skillTable_sdhandling_linkDen" class="lev{{ skills.handling.0 }}" title="{{ skills.handling }}">{{ skills.handling.1 }}</a>
                        </td>
                    </tr>
                    <tr style="background: #EFEFEF;">
                        <td>
                            Driving:

                            <a id="ctl00_cphContent_skillTable_sddriving_linkDen" class="lev{{ skills.driving.0 }}" title="{{ skills.driving }}">{{ skills.driving.1 }}</a>
                        </td>
                        <td>
                            Passing:

                            <a id="ctl00_cphContent_skillTable_sdpassing_linkDen" class="lev{{ skills.passing.0 }}" title="{{ skills.passing }}">{{ skills.passing.1 }}</a>
                        </td>
                    </tr>
                    <tr style="background: #EFEFEF;">
                        <td>
                            Inside Shot:

                            <a id="ctl00_cphContent_skillTable_sdinsideShot_linkDen" class="lev{{ skills.inside_shot.0 }}" title="{{ skills.inside_shot }}">{{ skills.inside_shot.1 }}</a>
                        </td>
                        <td>
                            Inside Def.:

                            <a id="ctl00_cphContent_skillTable_sdinsideDef_linkDen" class="lev{{ skills.inside_def.0 }}" title="{{ skills.inside_def }}">{{ skills.inside_def.1 }}</a>
                        </td>
                    </tr>
                    <tr style="background: #EFEFEF;">
                        <td>
                            Rebounding:

                            <a id="ctl00_cphContent_skillTable_sdrebound_linkDen" class="lev{{ skills.rebounding.0 }}" title="{{ skills.rebounding }}">{{ skills.rebounding.1 }}</a>
                        </td>
                        <td>
                            Shot Blocking:

                            <a id="ctl00_cphContent_skillTable_sdshotBlock_linkDen" class="lev{{ skills.shot_blocking.0 }}" title="{{ skills.shot_blocking }}">{{ skills.shot_blocking.1 }}</a>
                        </td>
                    </tr>
                    <tr style="background: #EFEFEF;">
                        <td>
                            Stamina:

                            <a id="ctl00_cphContent_skillTable_sdstamina_linkDen" class="lev{{ skills.stamina.0 }}" title="{{ skills.stamina }}">{{ skills.stamina.1 }}</a>
                        </td>
                        <td>
                            Free Throw:

                            <a id="ctl00_cphContent_skillTable_sdfreeThrow_linkDen" class="lev{{ skills.free_throw.0 }}" title="{{ skills.free_throw }}">{{ skills.free_throw.1 }}</a>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 170px; background: #FFFFFF;">
                            &nbsp;</td>
                        <td style="width: 170px; background: #FFFFFF;">
                            &nbsp;</td>
                    </tr>
                    <tr id="ctl00_cphContent_skillTable_trExperience" style="background: #EFEFEF;">
                        <td>
                            Experience:

                            <a id="ctl00_cphContent_skillTable_sdexperience_linkDen" class="lev{{ skills.experience.0 }}" title="{{ skills.experience }}">{{ skills.experience.1 }}</a>
                        </td>
                        <td>
                            TSP:
                            <b>{{ tsp }}</b> ({{ gsp }} + {{ fsp }})

                        </td>
                    </tr>
                </table>
            </td>
            {% endif %}


        </tr>

    </table>
    <p><b>Transfer estimate</b>: {{ player.transfer_estimate }}</p>
    <div id="playerhistory" class="widebox" style=" ">
        <div class="boxheader" style="border-top-left-radius:4px;border-top-right-radius:4px;padding-left:6px;padding-right:6px; ">
            <div style="float: left">
                Player history for {{ player.name }}
            </div>
            <div style="width: 128px; position: relative; float: right;">
                <select name="ctl00$cphContent$ddlSeasons" onchange="javascript:setTimeout('__doPostBack(\'ctl00$cphContent$ddlSeasons\',\'\')', 0)" id="ctl00_cphContent_ddlSeasons" style="margin-top:-2px">
                    <option selected="selected" value="43">Season 43</option>
                    <option value="42">Season 42</option>
                </select>
            </div>
            <div></div>
        </div>
        <div class="boxcontent" style="">
            <a name="playerstats"></a>
            <div>
                <table id="matchHistory" class="compact" >
                    <thead>
                        <tr>
                            <th>match_id</th>
                            <th>Season</th>
                            <th style="width: 150px !important">Game</th>
                            <th>POS</th>
                            <th>MIN</th>
                            <th>FG</th>
                            <th>3FG</th>
                            <th>FT</th>
                            <th>OR</th>
                            <th>TR</th>
                            <th>AST</th>
                            <th>TO</th>
                            <th>STL</th>
                            <th>BLK</th>
                            <th>PF</th>
                            <th>PTS</th>
                            <th>Rating</th>
                            <th>Game Type</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for stat in stats %}
                        <tr>
                            <td>{{ stat.match.match.id }}</td>
                            <td align="center">Season {{ stat.match.match.season }}</td>
                            <td align="center">
                                <a id="ctl00_cphContent_playerStats_ctl02_HyperLink1" href="http://www.buzzerbeater.com/match/{{ stat.match.id }}/boxscore.aspx">{{ stat.match.match.match_date|date:"y-m-d" }}</a>
                            </td>
                            <td align="center">{{ stat.max_minute_key }}</td>
                            <td align="center">{{ stat.max_minute_value }}</td>
                            <td align="center">
                                {{ stat.match.fgm }}-{{ stat.match.fga }}
                            </td>
                            <td align="center">
                                {{ stat.match.tpm }}-{{ stat.match.tpa }}
                            </td>
                            <td align="center">
                                {{ stat.match.ftm }}-{{ stat.match.fta }}
                            </td>
                            <td align="center">{{ stat.match.oreb }}</td>
                            <td align="center">{{ stat.match.reb }}</td>
                            <td align="center">{{ stat.match.ast }}</td>
                            <td align="center">{{ stat.match.t_o }}</td>
                            <td align="center">{{ stat.match.stl }}</td>
                            <td align="center">{{ stat.match.blk }}</td>
                            <td align="center">{{ stat.match.pf }}</td>
                            <td align="center">{{ stat.match.pts }}</td>
                            <td align="center">
                                {{ stat.match.rating }}
                            </td>
                            <td align="center">
                                {{ stat.match_type }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr style="background-color:#EEEEEE;">
                            <td align="center">&nbsp;</td>
                            <td align="center">&nbsp;</td>
                            <td align="center">
                                <a id="ctl00_cphContent_playerStats_ctl03_HyperLink1" href="../../match/0/boxscore.aspx"></a>
                            </td>
                            <td align="center">&nbsp;</td>
                            <td align="center">0.0</td>
                            <td align="center">
                                0.000
                            </td>
                            <td align="center">
                                0.000
                            </td>
                            <td align="center">
                                0.000
                            </td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">0.0</td>
                            <td align="center">
                                0.0
                            </td>
                            <td align="center">
                                SEASON AVG
                            </td>
                        </tr>
                        <tr>
                            <td align="center">&nbsp;</td>
                            <td align="center">&nbsp;</td>
                            <td align="center">
                                <a id="ctl00_cphContent_playerStats_ctl04_HyperLink1" href="../../match/1/boxscore.aspx"></a>
                            </td>
                            <td align="center">&nbsp;</td>
                            <td align="center">0</td>
                            <td align="center">
                                0-0
                            </td>
                            <td align="center">
                                0-0
                            </td>
                            <td align="center">
                                0-0
                            </td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center">0</td>
                            <td align="center"></td>
                            <td align="center">
                                TOTALS
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

</div>

{% else %}

<p>Player ID not in the database</p>
{% endif %}
